<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tommy HQ ‚Äî Mission Control</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0a0a0f;--bg2:#12121a;--bg3:#1a1a2e;--bg4:#22223a;
  --coral:#ff6b6b;--cyan:#00d4aa;--purple:#7c6bff;--amber:#ffb86b;
  --text:#e8e8f0;--text2:#8888a0;--text3:#55556a;
  --radius:12px;--radius-sm:8px;
}
html,body{height:100%;font-family:'Inter',system-ui,sans-serif;background:var(--bg);color:var(--text);overflow-x:hidden}
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}

/* NAV */
.nav{display:flex;align-items:center;justify-content:space-between;padding:14px 24px;border-bottom:1px solid var(--bg4);background:var(--bg2);position:sticky;top:0;z-index:100;flex-wrap:wrap;gap:10px}
.nav-left{display:flex;align-items:center;gap:10px}
.nav-left h1{font-size:18px;font-weight:800;letter-spacing:-0.5px;background:linear-gradient(135deg,var(--coral),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.nav-dot{width:8px;height:8px;border-radius:50%;background:var(--cyan);box-shadow:0 0 10px var(--cyan);animation:pulse 2s infinite}
.nav-tabs{display:flex;gap:2px;flex-wrap:wrap}
.nav-tab{padding:7px 14px;border-radius:var(--radius-sm);font-size:13px;font-weight:600;cursor:pointer;color:var(--text2);background:transparent;border:none;font-family:inherit;transition:all .2s;position:relative;white-space:nowrap}
.nav-tab:hover{color:var(--text);background:var(--bg3)}
.nav-tab.active{color:var(--coral);background:var(--bg3)}
.nav-tab.active::after{content:'';position:absolute;bottom:0;left:14px;right:14px;height:2px;background:var(--coral);border-radius:1px}
.nav-tab .badge{position:absolute;top:2px;right:2px;background:var(--coral);color:#fff;font-size:9px;font-weight:700;padding:1px 4px;border-radius:8px;min-width:14px;text-align:center}
.nav-right{display:flex;align-items:center;gap:12px;font-size:12px;color:var(--text2)}
.online{display:flex;align-items:center;gap:5px;color:#00ff88;font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:1px}
.online .dot{width:6px;height:6px;border-radius:50%;background:#00ff88;box-shadow:0 0 8px #00ff88;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* GLOBAL STATS */
.global-stats{display:flex;gap:0;border-bottom:1px solid var(--bg4);background:var(--bg2)}
.gs{padding:10px 24px;font-size:12px;color:var(--text2);border-right:1px solid var(--bg4);display:flex;align-items:center;gap:6px}
.gs strong{color:var(--text);font-weight:700;font-size:15px}

/* SECTIONS */
.section{display:none;padding:20px 24px;min-height:calc(100vh - 110px)}
.section.active{display:block}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px}
.section-title{font-size:18px;font-weight:700}

/* BUTTONS */
.btn{padding:8px 16px;border-radius:var(--radius-sm);font-size:13px;font-weight:600;cursor:pointer;border:none;font-family:inherit;transition:all .2s}
.btn-coral{background:linear-gradient(135deg,var(--coral),#ff4757);color:#fff;box-shadow:0 0 15px #ff6b6b33}
.btn-coral:hover{transform:translateY(-1px);box-shadow:0 0 25px #ff6b6b55}
.btn-ghost{background:transparent;color:var(--text2);border:1px solid var(--bg4)}
.btn-ghost:hover{border-color:var(--text3);color:var(--text)}
.btn-green{background:#00c853;color:#fff;font-weight:700}
.btn-red{background:#ff3d3d;color:#fff;font-weight:700}
.btn-sm{padding:5px 10px;font-size:12px}

/* FILTERS */
.filters{display:flex;gap:6px;margin-bottom:14px;flex-wrap:wrap}
.filter-btn{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:500;cursor:pointer;border:1px solid var(--bg4);background:var(--bg2);color:var(--text2);transition:all .2s;font-family:inherit}
.filter-btn:hover{border-color:var(--text3);color:var(--text)}
.filter-btn.active{background:var(--coral);border-color:var(--coral);color:#fff}

/* KANBAN */
.kanban{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;align-items:start}
@media(max-width:900px){.kanban{grid-template-columns:repeat(2,1fr)}}
@media(max-width:500px){.kanban{grid-template-columns:1fr}}
.kanban-col{background:var(--bg2);border-radius:var(--radius);border:1px solid var(--bg4);overflow:hidden}
.kanban-col-header{padding:12px 14px;font-size:13px;font-weight:700;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--bg4)}
.col-count{background:var(--bg4);color:var(--text2);font-size:11px;padding:2px 7px;border-radius:10px;font-weight:600}
.kanban-cards{padding:10px;min-height:80px;display:flex;flex-direction:column;gap:8px}
.kanban-cards.drag-over{background:var(--bg3)}

/* CARDS */
.card{background:var(--bg3);border:1px solid var(--bg4);border-radius:var(--radius-sm);padding:12px;cursor:grab;transition:all .2s;position:relative}
.card:hover{border-color:var(--text3);transform:translateY(-1px);box-shadow:0 4px 15px #0005}
.card.dragging{opacity:.4}
.card-title{font-size:13px;font-weight:600;margin-bottom:8px;line-height:1.3}
.card-meta{display:flex;align-items:center;gap:6px;flex-wrap:wrap}
.agent-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.badge-pill{font-size:10px;font-weight:600;padding:2px 7px;border-radius:8px;background:var(--bg4);color:var(--text2)}
.badge-pill.high{background:#ff6b6b22;color:#ff6b6b}
.badge-pill.medium{background:#ffb86b22;color:#ffb86b}
.badge-pill.low{background:#00d4aa22;color:#00d4aa}
.card-actions{display:flex;gap:4px;margin-top:8px}

/* STATS ROW */
.stats-row{display:flex;gap:16px;margin-bottom:16px;flex-wrap:wrap}
.stat{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius-sm);padding:10px 16px}
.stat .val{font-size:22px;font-weight:800;background:linear-gradient(135deg,var(--coral),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.stat .lbl{font-size:11px;color:var(--text2);margin-top:2px}

/* APPROVALS */
.approval-card{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:16px;margin-bottom:10px;transition:all .2s}
.approval-card.high{border-color:#ff6b6b55;animation:glow-coral 3s infinite}
@keyframes glow-coral{0%,100%{box-shadow:0 0 0 #ff6b6b00}50%{box-shadow:0 0 15px #ff6b6b33}}
.approval-card.resolved{opacity:.5}
.approval-header{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.approval-title{font-size:14px;font-weight:700;flex:1}
.approval-desc{font-size:12px;color:var(--text2);margin-bottom:12px;line-height:1.5}
.approval-actions{display:flex;gap:8px}
.type-badge{font-size:10px;font-weight:700;padding:3px 8px;border-radius:6px;text-transform:uppercase;letter-spacing:.5px}
.type-content{background:#00d4aa22;color:#00d4aa}
.type-spend{background:#ff6b6b22;color:#ff6b6b}
.type-action{background:#7c6bff22;color:#7c6bff}
.type-campaign{background:#ffb86b22;color:#ffb86b}

/* DOCS */
.docs-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
@media(max-width:900px){.docs-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:500px){.docs-grid{grid-template-columns:1fr}}
.doc-card{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:14px;cursor:pointer;transition:all .2s}
.doc-card:hover{border-color:var(--cyan);transform:translateY(-2px);box-shadow:0 6px 20px #00d4aa22}
.doc-cat{font-size:10px;font-weight:700;padding:2px 8px;border-radius:6px;text-transform:uppercase;letter-spacing:.5px;display:inline-block;margin-bottom:8px}
.cat-sop{background:#ff6b6b22;color:#ff6b6b}
.cat-copy{background:#00d4aa22;color:#00d4aa}
.cat-strategy{background:#7c6bff22;color:#7c6bff}
.cat-research{background:#ffb86b22;color:#ffb86b}
.cat-script{background:#00d4aa22;color:#00d4aa}
.cat-pipeline{background:#ff6b6b22;color:#ff6b6b}
.doc-title{font-size:13px;font-weight:700;margin-bottom:6px}
.doc-desc{font-size:12px;color:var(--text2);line-height:1.4;margin-bottom:8px}
.doc-tags{display:flex;gap:4px;flex-wrap:wrap}
.doc-tag{font-size:10px;padding:2px 6px;border-radius:4px;background:var(--bg4);color:var(--text3)}

/* DOC PANEL */
.doc-panel{position:fixed;right:-500px;top:0;width:500px;height:100vh;background:var(--bg2);border-left:1px solid var(--bg4);z-index:200;transition:right .3s;display:flex;flex-direction:column}
.doc-panel.open{right:0;box-shadow:-10px 0 40px #0008}
.doc-panel-header{padding:16px 20px;border-bottom:1px solid var(--bg4);display:flex;align-items:center;justify-content:space-between}
.doc-panel-title{font-size:15px;font-weight:700}
.doc-panel-body{flex:1;overflow-y:auto;padding:20px;font-size:13px;line-height:1.7;color:var(--text2);white-space:pre-wrap;font-family:monospace}

/* ACTIVITY */
.activity-feed{display:flex;flex-direction:column;gap:0}
.activity-item{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid var(--bg4);align-items:flex-start}
.activity-item:last-child{border-bottom:none}
.activity-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0;margin-top:4px}
.activity-left{min-width:90px;text-align:right;font-size:11px;color:var(--text3);padding-right:4px}
.activity-right{flex:1}
.activity-agent{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px}
.activity-action{font-size:13px;font-weight:600;color:var(--text)}
.activity-details{font-size:12px;color:var(--text2);margin-top:2px;line-height:1.4}
.activity-time{font-size:11px;color:var(--text3);margin-top:3px}
.refresh-note{font-size:11px;color:var(--text3);margin-bottom:12px}

/* TEAM */
.team-page{max-width:900px;margin:0 auto}
.team-quote{background:var(--bg3);border:1px solid var(--bg4);border-radius:var(--radius);padding:16px 24px;margin-bottom:28px;font-size:14px;font-style:italic;color:var(--text2);text-align:center;line-height:1.6}
.team-quote span{color:var(--text);font-weight:500}
.team-heading{text-align:center;margin-bottom:28px}
.team-heading h2{font-size:28px;font-weight:800;margin-bottom:6px;background:linear-gradient(135deg,var(--coral),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.team-heading p{font-size:13px;color:var(--text2)}
/* Chief card */
.chief-card{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:20px 24px;display:flex;align-items:center;gap:20px;margin-bottom:0;transition:all .3s}
.chief-card:hover{border-color:#ff6b6b55;box-shadow:0 8px 30px #ff6b6b22}
.agent-avatar{width:72px;height:72px;border-radius:14px;object-fit:cover;background:var(--bg4);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:36px;overflow:hidden}
.agent-avatar img{width:100%;height:100%;object-fit:cover;border-radius:14px}
.chief-info{flex:1}
.chief-name{font-size:20px;font-weight:800;margin-bottom:2px}
.chief-role{font-size:13px;color:var(--text2);margin-bottom:6px}
.chief-desc{font-size:12px;color:var(--text2);line-height:1.5;margin-bottom:10px}
.role-card-btn{font-size:12px;color:var(--text3);text-decoration:none;font-weight:600;letter-spacing:.5px;transition:color .2s;background:none;border:none;cursor:pointer;font-family:inherit}
.role-card-btn:hover{color:var(--coral)}
/* Org connector */
.org-connector{display:flex;flex-direction:column;align-items:center;padding:8px 0;gap:0}
.org-line{width:1px;height:24px;background:var(--bg4)}
.org-labels{display:flex;width:100%;justify-content:space-between;align-items:center;padding:8px 0;position:relative}
.org-labels::before{content:'';position:absolute;top:50%;left:20%;right:20%;height:1px;background:var(--bg4)}
.org-label{font-size:10px;color:var(--text3);font-weight:600;letter-spacing:1px;text-transform:uppercase;background:var(--bg);padding:0 8px;z-index:1;position:relative}
/* Agent row */
.agents-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
@media(max-width:900px){.agents-row{grid-template-columns:repeat(2,1fr)}}
@media(max-width:500px){.agents-row{grid-template-columns:1fr}}
.agent-card{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:16px;transition:all .3s}
.agent-neo:hover{box-shadow:0 8px 25px #00d4aa22;border-color:#00d4aa55}
.agent-drago:hover{box-shadow:0 8px 25px #7c6bff22;border-color:#7c6bff55}
.agent-happy:hover{box-shadow:0 8px 25px #ffb86b22;border-color:#ffb86b55}
.agent-bob:hover{box-shadow:0 8px 25px #e879f922;border-color:#e879f955}
.agent-header{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.agent-sm-avatar{width:48px;height:48px;border-radius:10px;object-fit:cover;background:var(--bg4);flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:24px;overflow:hidden}
.agent-sm-avatar img{width:100%;height:100%;object-fit:cover;border-radius:10px}
.agent-name{font-size:16px;font-weight:800;margin-bottom:2px}
.agent-role{font-size:11px;color:var(--text2)}
.agent-desc{font-size:12px;color:var(--text2);line-height:1.5;margin-bottom:10px}
.agent-skills{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:12px}
.skill-tag{font-size:10px;padding:2px 8px;border-radius:5px;font-weight:600}
/* Meta layer */
.meta-layer{display:flex;align-items:center;gap:12px;margin:20px 0 16px}
.meta-layer-line{flex:1;height:1px;background:var(--bg4)}
.meta-layer-label{font-size:10px;color:var(--text3);font-weight:600;letter-spacing:1.5px;text-transform:uppercase;display:flex;align-items:center;gap:6px}
.meta-layer-label::before{content:'‚óè';font-size:8px}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:#000a;z-index:300;display:none;align-items:center;justify-content:center}
.modal-overlay.open{display:flex}
.modal{background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);padding:24px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto}
.modal h2{font-size:16px;font-weight:700;margin-bottom:16px}
.form-group{margin-bottom:14px}
.form-group label{font-size:12px;color:var(--text2);display:block;margin-bottom:5px;font-weight:500}
.form-group input,.form-group select,.form-group textarea{width:100%;background:var(--bg3);border:1px solid var(--bg4);border-radius:var(--radius-sm);padding:9px 12px;color:var(--text);font-family:inherit;font-size:13px;outline:none;transition:border .2s}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{border-color:var(--coral)}
.form-group textarea{min-height:80px;resize:vertical}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}

/* SEARCH */
.search-bar{width:100%;background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius-sm);padding:9px 14px;color:var(--text);font-family:inherit;font-size:13px;outline:none;margin-bottom:14px;transition:border .2s}
.search-bar:focus{border-color:var(--cyan)}

/* EMPTY STATE */
.empty{text-align:center;padding:40px;color:var(--text3)}
.empty-icon{font-size:36px;margin-bottom:10px}
.empty p{font-size:13px}
</style>
</head>
<body>

<nav class="nav">
  <div class="nav-left">
    <div class="nav-dot"></div>
    <h1>TOMMY HQ</h1>
  </div>
  <div class="nav-tabs">
    <button class="nav-tab active" data-tab="tasks">üìã Tasks</button>
    <button class="nav-tab" data-tab="content">üìù Content</button>
    <button class="nav-tab" data-tab="approvals" id="approvalTab">‚úÖ Approvals</button>
    <button class="nav-tab" data-tab="docs">üìÅ Docs</button>
    <button class="nav-tab" data-tab="activity">‚ö° Activity</button>
    <button class="nav-tab" data-tab="team">üë• Team</button>
  </div>
  <div class="nav-right">
    <span id="clock"></span>
    <div class="online"><div class="dot"></div>SYSTEMS ONLINE</div>
  </div>
</nav>

<div class="global-stats">
  <div class="gs"><strong id="gs-tasks">‚Äì</strong> Open Tasks</div>
  <div class="gs"><strong id="gs-approvals">‚Äì</strong> Pending Approvals</div>
  <div class="gs"><strong id="gs-content">‚Äì</strong> Content in Pipeline</div>
  <div class="gs"><strong id="gs-docs">‚Äì</strong> Docs</div>
</div>

<!-- TASKS -->
<div class="section active" id="sec-tasks">
  <div class="section-header">
    <div class="section-title">üìã Task Board</div>
    <button class="btn btn-coral" onclick="openModal('task')">+ New Task</button>
  </div>
  <div class="stats-row" id="taskStats"></div>
  <div class="filters" id="taskFilters">
    <button class="filter-btn active" data-val="all">ALL</button>
    <button class="filter-btn" data-val="charlie">üöÄ Charlie</button>
    <button class="filter-btn" data-val="neo">üï∂Ô∏è Neo</button>
    <button class="filter-btn" data-val="drago">ü•ä Drago</button>
    <button class="filter-btn" data-val="happy">‚õ≥ Happy</button>
  </div>
  <div class="kanban" id="taskBoard">
    <div class="kanban-col" ondragover="dragOver(event)" ondrop="drop(event,'todo')" ondragleave="dragLeave(event)">
      <div class="kanban-col-header">To Do <span class="col-count" id="cnt-todo">0</span></div>
      <div class="kanban-cards" id="col-todo"></div>
    </div>
    <div class="kanban-col" ondragover="dragOver(event)" ondrop="drop(event,'in-progress')" ondragleave="dragLeave(event)">
      <div class="kanban-col-header">In Progress <span class="col-count" id="cnt-in-progress">0</span></div>
      <div class="kanban-cards" id="col-in-progress"></div>
    </div>
    <div class="kanban-col" ondragover="dragOver(event)" ondrop="drop(event,'review')" ondragleave="dragLeave(event)">
      <div class="kanban-col-header">Review <span class="col-count" id="cnt-review">0</span></div>
      <div class="kanban-cards" id="col-review"></div>
    </div>
    <div class="kanban-col" ondragover="dragOver(event)" ondrop="drop(event,'done')" ondragleave="dragLeave(event)">
      <div class="kanban-col-header">Done <span class="col-count" id="cnt-done">0</span></div>
      <div class="kanban-cards" id="col-done"></div>
    </div>
  </div>
</div>

<!-- CONTENT -->
<div class="section" id="sec-content">
  <div class="section-header">
    <div class="section-title">üìù Content Pipeline</div>
    <button class="btn btn-coral" onclick="openModal('content')">+ New Content</button>
  </div>
  <div class="filters" id="contentAgentFilters">
    <button class="filter-btn active" data-val="all">ALL</button>
    <button class="filter-btn" data-val="charlie">üöÄ Charlie</button>
    <button class="filter-btn" data-val="neo">üï∂Ô∏è Neo</button>
    <button class="filter-btn" data-val="drago">ü•ä Drago</button>
    <button class="filter-btn" data-val="happy">‚õ≥ Happy</button>
  </div>
  <div class="filters" id="contentPillarFilters">
    <button class="filter-btn active" data-val="all">ALL PILLARS</button>
    <button class="filter-btn" data-val="Dropship">Dropship</button>
    <button class="filter-btn" data-val="KYVO">KYVO</button>
    <button class="filter-btn" data-val="Golf">Golf</button>
    <button class="filter-btn" data-val="BBA">BBA</button>
  </div>
  <div class="kanban" id="contentBoard">
    <div class="kanban-col">
      <div class="kanban-col-header">Draft <span class="col-count" id="ccnt-Draft">0</span></div>
      <div class="kanban-cards" id="ccol-Draft"></div>
    </div>
    <div class="kanban-col">
      <div class="kanban-col-header">Review <span class="col-count" id="ccnt-Review">0</span></div>
      <div class="kanban-cards" id="ccol-Review"></div>
    </div>
    <div class="kanban-col">
      <div class="kanban-col-header">Approved <span class="col-count" id="ccnt-Approved">0</span></div>
      <div class="kanban-cards" id="ccol-Approved"></div>
    </div>
    <div class="kanban-col">
      <div class="kanban-col-header">Posted <span class="col-count" id="ccnt-Posted">0</span></div>
      <div class="kanban-cards" id="ccol-Posted"></div>
    </div>
  </div>
</div>

<!-- APPROVALS -->
<div class="section" id="sec-approvals">
  <div class="section-header">
    <div class="section-title">‚úÖ Approvals Queue</div>
    <div style="display:flex;gap:8px">
      <button class="btn btn-ghost" id="historyBtn" onclick="toggleApprovalHistory()">Show History</button>
      <button class="btn btn-coral" onclick="openModal('approval')">+ New Request</button>
    </div>
  </div>
  <div id="approvalsList"></div>
</div>

<!-- DOCS -->
<div class="section" id="sec-docs">
  <div class="section-header">
    <div class="section-title">üìÅ Document Library</div>
    <button class="btn btn-coral" onclick="openModal('doc')">+ Add Doc</button>
  </div>
  <input type="text" class="search-bar" id="docSearch" placeholder="Search docs..." oninput="renderDocs()">
  <div class="filters" id="docCatFilters">
    <button class="filter-btn active" data-val="all">ALL</button>
    <button class="filter-btn" data-val="SOP">SOP</button>
    <button class="filter-btn" data-val="Copy">Copy</button>
    <button class="filter-btn" data-val="Script">Script</button>
    <button class="filter-btn" data-val="Strategy">Strategy</button>
    <button class="filter-btn" data-val="Research">Research</button>
    <button class="filter-btn" data-val="Pipeline">Pipeline</button>
  </div>
  <div class="docs-grid" id="docsGrid"></div>
</div>

<div class="doc-panel" id="docPanel">
  <div class="doc-panel-header">
    <div class="doc-panel-title" id="docPanelTitle"></div>
    <button class="btn btn-ghost btn-sm" onclick="closeDocPanel()">‚úï Close</button>
  </div>
  <div class="doc-panel-body" id="docPanelContent">Loading...</div>
</div>

<!-- ACTIVITY -->
<div class="section" id="sec-activity">
  <div class="section-header">
    <div class="section-title">‚ö° Activity Feed</div>
    <button class="btn btn-ghost" onclick="fetchAndRenderActivity()">‚Üª Refresh</button>
  </div>
  <div class="filters" id="activityFilters">
    <button class="filter-btn active" data-val="all">ALL</button>
    <button class="filter-btn" data-val="charlie">üöÄ Charlie</button>
    <button class="filter-btn" data-val="neo">üï∂Ô∏è Neo</button>
    <button class="filter-btn" data-val="drago">ü•ä Drago</button>
    <button class="filter-btn" data-val="happy">‚õ≥ Happy</button>
  </div>
  <div class="activity-feed" id="activityFeed"></div>
</div>

<!-- TEAM -->
<div class="section" id="sec-team">
  <div class="team-page">
    <div class="team-quote"><span>"Build an empire so my children inherit freedom, not limitation."</span></div>
    <div class="team-heading">
      <h2>Meet the Team</h2>
      <p>5 AI agents, each with a real role and a real personality.</p>
      <p style="margin-top:12px;font-size:13px;color:var(--text2);font-style:italic;line-height:1.8;max-width:640px;margin-left:auto;margin-right:auto">
        "We build for Tommy's family. Not for vanity. Not for scorecards.<br>
        Because behind every pipeline we run, every ad we launch, every brief we write ‚Äî<br>
        there are four kids who deserve a life without limits.<br>
        <strong style="color:var(--text);font-style:normal">We move fast, we work clean, and we never forget why.</strong>"
      </p>
    </div>

    <!-- Charlie ‚Äî Chief of Staff -->
    <div class="chief-card">
      <div class="agent-avatar" id="avatar-charlie">üöÄ</div>
      <div class="chief-info">
        <div class="chief-name" style="color:var(--coral)">Charlie</div>
        <div class="chief-role">Super Agent / Chief of Staff</div>
        <div class="chief-desc">Coordinates, delegates, keeps the ship tight. The first point of contact between Tommy and the machine. Orchestrates all 4 pillars and makes sure nothing falls through the cracks.</div>
        <div class="agent-skills">
          <span class="skill-tag" style="background:#ff6b6b22;color:#ff6b6b">Orchestration</span>
          <span class="skill-tag" style="background:#ff6b6b22;color:#ff6b6b">Strategy</span>
          <span class="skill-tag" style="background:#ff6b6b22;color:#ff6b6b">Morning Brief</span>
          <span class="skill-tag" style="background:#ff6b6b22;color:#ff6b6b">Memory</span>
          <span class="skill-tag" style="background:#ff6b6b22;color:#ff6b6b">Copywriting</span>
        </div>
        <button class="role-card-btn">ROLE CARD ‚Üí</button>
      </div>
    </div>

    <!-- Connector -->
    <div class="org-connector">
      <div class="org-line"></div>
      <div class="org-labels">
        <div class="org-label">‚Üì INPUT SIGNAL</div>
        <div class="org-label">OUTPUT ACTION ‚Üì</div>
      </div>
    </div>

    <!-- Specialist Agents -->
    <div class="agents-row">
      <div class="agent-card agent-neo">
        <div class="agent-header">
          <div class="agent-sm-avatar" id="avatar-neo">üï∂Ô∏è</div>
          <div>
            <div class="agent-name" style="color:var(--cyan)">Neo</div>
            <div class="agent-role">Dropship Intelligence</div>
          </div>
        </div>
        <div class="agent-desc">Sees through the matrix of ads and data. Finds winning products, builds full funnels, tracks competitors, runs the pipeline.</div>
        <div class="agent-skills">
          <span class="skill-tag" style="background:#00d4aa22;color:#00d4aa">Product Research</span>
          <span class="skill-tag" style="background:#00d4aa22;color:#00d4aa">Pipeline</span>
          <span class="skill-tag" style="background:#00d4aa22;color:#00d4aa">Gethookd</span>
          <span class="skill-tag" style="background:#00d4aa22;color:#00d4aa">Facebook Ads</span>
        </div>
        <button class="role-card-btn">ROLE CARD ‚Üí</button>
      </div>

      <div class="agent-card agent-drago">
        <div class="agent-header">
          <div class="agent-sm-avatar" id="avatar-drago">ü•ä</div>
          <div>
            <div class="agent-name" style="color:var(--purple)">Drago</div>
            <div class="agent-role">KYVO Performance Director</div>
          </div>
        </div>
        <div class="agent-desc">Engineered for peak performance. Builds the KYVO supplements brand from strategy to copy to email ‚Äî relentless and precise.</div>
        <div class="agent-skills">
          <span class="skill-tag" style="background:#7c6bff22;color:#7c6bff">Supplement Strategy</span>
          <span class="skill-tag" style="background:#7c6bff22;color:#7c6bff">VSL Copy</span>
          <span class="skill-tag" style="background:#7c6bff22;color:#7c6bff">Email</span>
          <span class="skill-tag" style="background:#7c6bff22;color:#7c6bff">Brand</span>
        </div>
        <button class="role-card-btn">ROLE CARD ‚Üí</button>
      </div>

      <div class="agent-card agent-happy">
        <div class="agent-header">
          <div class="agent-sm-avatar" id="avatar-happy">‚õ≥</div>
          <div>
            <div class="agent-name" style="color:var(--amber)">Happy</div>
            <div class="agent-role">Golf & Content Coach</div>
          </div>
        </div>
        <div class="agent-desc">Happy Gilmore energy. Serious results. Coaches Tommy to scratch, builds @casualgolfdad, and turns every simulator session into content gold.</div>
        <div class="agent-skills">
          <span class="skill-tag" style="background:#ffb86b22;color:#ffb86b">Golf Coaching</span>
          <span class="skill-tag" style="background:#ffb86b22;color:#ffb86b">@casualgolfdad</span>
          <span class="skill-tag" style="background:#ffb86b22;color:#ffb86b">Sponsorships</span>
          <span class="skill-tag" style="background:#ffb86b22;color:#ffb86b">Content</span>
        </div>
        <button class="role-card-btn">ROLE CARD ‚Üí</button>
      </div>

      <div class="agent-card agent-bob">
        <div class="agent-header">
          <div class="agent-sm-avatar" id="avatar-bob">üé®</div>
          <div>
            <div class="agent-name" style="color:#e879f9">Bob</div>
            <div class="agent-role">Creative Agent</div>
          </div>
        </div>
        <div class="agent-desc">Named after Bob Ross. Turns product briefs into scroll-stopping ad creatives. Every image is a weapon. Happy little accidents that convert.</div>
        <div class="agent-skills">
          <span class="skill-tag" style="background:#e879f922;color:#e879f9">Ad Creatives</span>
          <span class="skill-tag" style="background:#e879f922;color:#e879f9">Product Photos</span>
          <span class="skill-tag" style="background:#e879f922;color:#e879f9">Higgsfield</span>
          <span class="skill-tag" style="background:#e879f922;color:#e879f9">Brand Visuals</span>
        </div>
        <button class="role-card-btn">ROLE CARD ‚Üí</button>
      </div>
    </div>

    <!-- Meta Layer -->
    <div class="meta-layer">
      <div class="meta-layer-line"></div>
      <div class="meta-layer-label">META LAYER ‚Äî The Mission</div>
      <div class="meta-layer-line"></div>
    </div>
    <div style="text-align:center;padding:16px 24px;background:var(--bg2);border:1px solid var(--bg4);border-radius:var(--radius);font-size:13px;color:var(--text2);line-height:1.7">
      "I am building an autonomous empire ‚Äî one system, one agent, one dollar at a time ‚Äî<br>
      so that my children grow up knowing no ceiling.<br>
      Every 4:30am alarm, every product launched, every agent deployed is a brick in the foundation<br>
      of <strong style="color:var(--text)">a life they'll never need to escape.</strong>"
    </div>
  </div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="if(event.target===this)closeModal()">
  <div class="modal" id="modalContent"></div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ CONSTANTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const COLORS = {charlie:'var(--coral)',neo:'var(--cyan)',drago:'var(--purple)',happy:'var(--amber)'};
const API_KEY = 'thq_25741469f31452628a1d8ae7372155ef2a2bf0b7d0138d96';

// ‚îÄ‚îÄ‚îÄ STORAGE (localStorage + API sync) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function load(key){try{return JSON.parse(localStorage.getItem('tmhq_'+key)||'null')}catch{return null}}
function save(key,val){localStorage.setItem('tmhq_'+key,JSON.stringify(val))}
function genId(){return Date.now().toString(36)+Math.random().toString(36).slice(2,6)}

// ‚îÄ‚îÄ‚îÄ DEFAULT DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const DEFAULT_TASKS = [
  {id:'t1',title:'Connect Meta Ads account',agent:'charlie',priority:'high',status:'todo',created:new Date(Date.now()-2*864e5).toISOString()},
  {id:'t2',title:'Launch RestCalm on Meta Ads',agent:'neo',priority:'high',status:'todo',created:new Date(Date.now()-864e5).toISOString()},
  {id:'t3',title:'Build KYVO landing page',agent:'drago',priority:'medium',status:'in-progress',created:new Date(Date.now()-3*864e5).toISOString()},
  {id:'t4',title:'Research winning wedge content hooks',agent:'happy',priority:'medium',status:'in-progress',created:new Date(Date.now()-864e5).toISOString()},
  {id:'t5',title:'Audit Anakampsi product copy for AI readability',agent:'charlie',priority:'medium',status:'todo',created:new Date(Date.now()-43200e3).toISOString()},
  {id:'t6',title:'Run product pipeline on new candidate',agent:'neo',priority:'high',status:'in-progress',created:new Date(Date.now()-7200e3).toISOString()},
  {id:'t7',title:'Write KYVO email welcome sequence',agent:'drago',priority:'medium',status:'review',created:new Date(Date.now()-2*864e5).toISOString()},
  {id:'t8',title:'Prepare simulator practice plan (Wed 5am)',agent:'happy',priority:'low',status:'done',created:new Date(Date.now()-864e5).toISOString()},
  {id:'t9',title:'Deploy copywriting knowledge base',agent:'charlie',priority:'high',status:'done',created:new Date(Date.now()-864e5).toISOString()},
  {id:'t10',title:'Set up Klaviyo abandoned cart flow',agent:'neo',priority:'medium',status:'todo',created:new Date(Date.now()-3600e3).toISOString()},
];

const DEFAULT_CONTENT = [
  {id:'c1',title:'Tiger Woods Masters return take',agent:'happy',pillar:'Golf',platform:'Instagram',status:'Draft',notes:'Will Tiger play Augusta? 7 weeks out ‚Äî massive content',created:new Date(Date.now()-3600e3).toISOString()},
  {id:'c2',title:'RestCalm FB ad ‚Äî 30sec UGC',agent:'neo',pillar:'Dropship',platform:'Facebook Ad',status:'Review',notes:'Hook: Still waking up at 3am with restless legs?',created:new Date(Date.now()-2*3600e3).toISOString()},
  {id:'c3',title:'KYVO pre-launch email #1',agent:'drago',pillar:'KYVO',platform:'Email',status:'Draft',notes:'Founding member offer ‚Äî lock in early pricing',created:new Date(Date.now()-5*3600e3).toISOString()},
  {id:'c4',title:'Bridgeman win ‚Äî underdog grind story',agent:'happy',pillar:'Golf',platform:'Instagram',status:'Approved',notes:'Unknown grinder beats the field at Riviera',created:new Date(Date.now()-24*3600e3).toISOString()},
  {id:'c5',title:'PelvaCare advertorial ‚Äî personal story',agent:'neo',pillar:'Dropship',platform:'Facebook Ad',status:'Posted',notes:'47,000 women finally sleeping through the night...',created:new Date(Date.now()-3*864e5).toISOString()},
];

const DEFAULT_APPROVALS = [
  {id:'a1',title:'Launch RestCalm Facebook Ad Campaign',description:'Ready to run $20/day test on RestCalm with the UGC 30-sec script. Targeting women 50-70 with RLS interest. Need approval to create the ad set.',agent:'neo',type:'Ad Spend',priority:'high',status:'pending',created:new Date(Date.now()-3600e3).toISOString()},
  {id:'a2',title:'Post Bridgeman content to @casualgolfdad',description:'Short reel ready: "Unknown grinder beats Rory at Riviera. You don\'t need to be famous, you need to be consistent." 45 seconds, no face cam needed.',agent:'happy',type:'Content',priority:'medium',status:'pending',created:new Date(Date.now()-2*3600e3).toISOString()},
  {id:'a3',title:'Add KYVO founding member CTA to bio link',description:'Update Linktree to include KYVO early access signup. Simple addition ‚Äî 2 min job. Just want sign-off before touching the profile.',agent:'drago',type:'Action',priority:'low',status:'pending',created:new Date(Date.now()-5*3600e3).toISOString()},
  {id:'a4',title:'Chomsters Facebook ad test',description:'Approved previous campaign. Kids U-shaped toothbrush targeting parents of 2-6 year olds.',agent:'neo',type:'Ad Spend',priority:'high',status:'approved',created:new Date(Date.now()-5*864e5).toISOString(),resolved:new Date(Date.now()-4*864e5).toISOString()},
];

const DEFAULT_DOCS = [
  {id:'d1',title:'Copy Bible',agent:'charlie',category:'SOP',description:'Master copywriting reference ‚Äî Schwartz, Ogilvy, Hormozi, Brunson, Cialdini and more',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/copy-bible.md',tags:['copywriting','frameworks','master-ref'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d2',title:'Hook Library',agent:'charlie',category:'Copy',description:'505 battle-tested hooks organized by 14 categories with psychological reasoning',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/hook-library.md',tags:['hooks','ads','copywriting'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d3',title:'Awareness Levels Guide',agent:'charlie',category:'Strategy',description:'Eugene Schwartz 5 awareness levels applied to our exact product niches',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/awareness-levels.md',tags:['schwartz','strategy','targeting'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d4',title:'Copy Research SOP',agent:'neo',category:'SOP',description:'Pre-writing research ‚Äî Amazon reviews, Reddit, Gethookd, customer avatar',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/copy-research-sop.md',tags:['research','sop','copywriting'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d5',title:'FB Ad Scripts ‚Äî 15sec',agent:'neo',category:'Script',description:'15-second Facebook/Instagram ad templates with real examples',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/scripts/fb-ad-15sec.md',tags:['facebook','ads','scripts'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d6',title:'VSL Long-Form Template',agent:'drago',category:'Script',description:'Full 3-5 minute VSL structure ‚Äî Agora + Brunson frameworks combined',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/scripts/vsl-long-form.md',tags:['vsl','video','sales'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d7',title:'Advertorial Templates',agent:'neo',category:'Script',description:'4 advertorial styles ‚Äî personal story, expert interview, listicle, news',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/scripts/advertorial.md',tags:['advertorial','native','copy'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d8',title:'Email Sequences',agent:'drago',category:'Copy',description:'14 emails ‚Äî welcome, abandoned cart, post-purchase, win-back',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/scripts/email-sequence.md',tags:['email','sequences','klaviyo'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d9',title:'Landing Page Template',agent:'neo',category:'Script',description:'10-section high-converting landing page with CTA copy guide',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/scripts/landing-page.md',tags:['landing-page','conversion','shopify'],created:new Date(Date.now()-864e5).toISOString()},
  {id:'d10',title:'Master Swipe File',agent:'charlie',category:'Research',description:'Curated winning ad examples organized by category and niche',file_path:'/Users/charlieclaw/.openclaw/workspace/sops/master-swipe-file.md',tags:['swipe','inspiration','winning-ads'],created:new Date(Date.now()-864e5).toISOString()},
];

const DEFAULT_ACTIVITY = [
  {id:'ac1',agent:'charlie',action:'Mission + Creed embedded in all agents',details:'North star and creed added to all 4 SOUL.md and USER.md files ‚Äî team aligned on the mission',ts:new Date(Date.now()-30*60e3).toISOString()},
  {id:'ac2',agent:'charlie',action:'Mission Control V2 deployed',details:'All 6 sections live ‚Äî Tasks, Content, Approvals, Docs, Activity, Team',ts:new Date(Date.now()-2*3600e3).toISOString()},
  {id:'ac3',agent:'charlie',action:'Built world-class copywriting knowledge base',details:'Copy Bible, Hook Library, 7 script templates, Research SOP ‚Äî all committed to GitHub',ts:new Date(Date.now()-5*3600e3).toISOString()},
  {id:'ac4',agent:'neo',action:'Pipeline running for new product',details:'Running full SOP 01-04 on new dropship candidate',ts:new Date(Date.now()-6*3600e3).toISOString()},
  {id:'ac5',agent:'charlie',action:'Morning Brief cron fixed',details:'Switched to direct message tool ‚Äî fires at 4:30am automatically to Tommy\'s Telegram',ts:new Date(Date.now()-8*3600e3).toISOString()},
  {id:'ac6',agent:'drago',action:'Copy Bible loaded and ready',details:'Read master copywriting reference ‚Äî KYVO content creation unlocked',ts:new Date(Date.now()-9*3600e3).toISOString()},
  {id:'ac7',agent:'happy',action:'Copy Bible loaded and ready',details:'505 hooks reviewed + golf-specific section noted ‚Äî @casualgolfdad scripts ready',ts:new Date(Date.now()-9*3600e3).toISOString()},
  {id:'ac8',agent:'neo',action:'Higgsfield API issue resolved',details:'Credentials added to TOOLS.md ‚Äî image generation working for pipeline',ts:new Date(Date.now()-10*3600e3).toISOString()},
  {id:'ac9',agent:'charlie',action:'Brave Search API confirmed working',details:'web_search tool live after env key fix in openclaw.json',ts:new Date(Date.now()-24*3600e3).toISOString()},
  {id:'ac10',agent:'charlie',action:'Google Calendar configured',details:'Full weekly schedule ‚Äî family time, simulator, gym, agent check-ins all recurring',ts:new Date(Date.now()-2*864e5).toISOString()},
  {id:'ac11',agent:'charlie',action:'GitHub backup running nightly',details:'All 4 workspaces backed up ‚Äî 3am daily cron clean',ts:new Date(Date.now()-2*864e5).toISOString()},
  {id:'ac12',agent:'neo',action:'RestCalm pipeline complete',details:'Restless Legs EMS Pad pages live at anakampsihealth.com',ts:new Date(Date.now()-3*864e5).toISOString()},
  {id:'ac13',agent:'neo',action:'PelvaCare pipeline complete',details:'Pelvic Floor EMS Trainer ‚Äî $10.77 COGS, 4900+ AliExpress sold, pages live',ts:new Date(Date.now()-3*864e5).toISOString()},
  {id:'ac14',agent:'drago',action:'Higgsfield credentials added',details:'API key + secret live in workspace-kyvo TOOLS.md for image generation',ts:new Date(Date.now()-4*864e5).toISOString()},
  {id:'ac15',agent:'happy',action:'Player profile created',details:'Handicap 8.6, wedge distance control = #1 weakness, practice plan set for Wed simulator',ts:new Date(Date.now()-4*864e5).toISOString()},
  {id:'ac16',agent:'charlie',action:'Agent names updated',details:'Scout‚ÜíNeo, Coach‚ÜíDrago, Caddie‚ÜíHappy ‚Äî all workspaces and openclaw.json updated',ts:new Date(Date.now()-5*864e5).toISOString()},
  {id:'ac17',agent:'charlie',action:'Kanban board v1 deployed',details:'Tommy HQ launched at tommy-hq.vercel.app with Vercel Blob backend',ts:new Date(Date.now()-6*864e5).toISOString()},
];

const TEAM = [
  {id:'charlie',name:'Charlie',emoji:'üöÄ',role:'Super Agent / Chief of Staff',tagline:'The general. Orchestrates every pillar.',color:'coral',skills:['Orchestration','Morning Brief','Memory','Strategy','Copywriting'],stats:{tasks:47,docs:12,days:14}},
  {id:'neo',name:'Neo',emoji:'üï∂Ô∏è',role:'Dropship Intelligence',tagline:'Sees through the matrix of ads and data.',color:'cyan',skills:['Product Research','Ad Analysis','Pipeline','Gethookd','Facebook Ads'],stats:{tasks:31,docs:8,days:14}},
  {id:'drago',name:'Drago',emoji:'ü•ä',role:'KYVO Performance Director',tagline:'Engineered for peak performance.',color:'purple',skills:['Supplement Strategy','VSL Copywriting','Brand Building','Email Sequences'],stats:{tasks:18,docs:6,days:14}},
  {id:'happy',name:'Happy',emoji:'‚õ≥',role:'Golf & Content Coach',tagline:'Happy Gilmore energy. Serious results.',color:'amber',skills:['Golf Coaching','@casualgolfdad','Sponsorships','Swing Analysis','Content Calendar'],stats:{tasks:22,docs:5,days:14}},
];

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let tasks = load('tasks') || DEFAULT_TASKS;
let contentItems = load('content') || DEFAULT_CONTENT;
let approvals = load('approvals') || DEFAULT_APPROVALS;
let docs = load('docs') || DEFAULT_DOCS;
let activities = load('activity') || DEFAULT_ACTIVITY;
let taskFilter='all', contentAgent='all', contentPillar='all', docCat='all', activityFilter='all', showHistory=false;
let dragId=null;

// ‚îÄ‚îÄ‚îÄ SAVE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function persist(){
  save('tasks',tasks); save('content',contentItems);
  save('approvals',approvals); save('docs',docs); save('activity',activities);
}

// ‚îÄ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function tick(){document.getElementById('clock').textContent=new Date().toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',second:'2-digit'});}
setInterval(tick,1000);tick();

// ‚îÄ‚îÄ‚îÄ GLOBAL STATS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateGlobalStats(){
  document.getElementById('gs-tasks').textContent = tasks.filter(t=>t.status!=='done').length;
  document.getElementById('gs-approvals').textContent = approvals.filter(a=>a.status==='pending').length;
  document.getElementById('gs-content').textContent = contentItems.filter(c=>c.status!=='Posted').length;
  document.getElementById('gs-docs').textContent = docs.length;
  const pending = approvals.filter(a=>a.status==='pending').length;
  const tab = document.getElementById('approvalTab');
  const existing = tab.querySelector('.badge');
  if(existing) existing.remove();
  if(pending>0){const b=document.createElement('span');b.className='badge';b.textContent=pending;tab.appendChild(b);}
}

// ‚îÄ‚îÄ‚îÄ NAV ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.querySelectorAll('.nav-tab').forEach(t=>{
  t.addEventListener('click',()=>{
    document.querySelectorAll('.nav-tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById('sec-'+t.dataset.tab).classList.add('active');
    renderSection(t.dataset.tab);
  });
});

function renderSection(tab){
  if(tab==='tasks')fetchAndRenderTasks();
  else if(tab==='content')renderContent();
  else if(tab==='approvals')renderApprovals();
  else if(tab==='docs')renderDocs();
  else if(tab==='activity')fetchAndRenderActivity();
  else if(tab==='team')renderTeam();
}

// ‚îÄ‚îÄ‚îÄ FILTER HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function bindFilters(containerId,getVar,setVar,onchange){
  document.getElementById(containerId).querySelectorAll('.filter-btn').forEach(b=>{
    b.addEventListener('click',()=>{
      document.getElementById(containerId).querySelectorAll('.filter-btn').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      setVar(b.dataset.val);
      onchange();
    });
  });
}

// ‚îÄ‚îÄ‚îÄ TASKS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function fetchAndRenderTasks(){
  try{
    const r=await fetch('/api/tasks');
    if(r.ok){
      const remote=await r.json();
      if(remote.length>0){tasks=remote;save('tasks',tasks);}
    }
  }catch{}
  renderTasks();
}
function renderTasks(){
  const filtered = taskFilter==='all'?tasks:tasks.filter(t=>t.agent===taskFilter);
  ['todo','in-progress','review','done'].forEach(s=>{
    const items=filtered.filter(t=>t.status===s);
    document.getElementById('col-'+s).innerHTML=items.length?items.map(cardHTML).join(''):'<div style="text-align:center;padding:20px;color:var(--text3);font-size:12px">Empty</div>';
    document.getElementById('cnt-'+s).textContent=items.length;
  });
  const total=tasks.length, done=tasks.filter(t=>t.status==='done').length, inprog=tasks.filter(t=>t.status==='in-progress').length;
  document.getElementById('taskStats').innerHTML=`
    <div class="stat"><div class="val">${inprog}</div><div class="lbl">In Progress</div></div>
    <div class="stat"><div class="val">${total-done}</div><div class="lbl">Open</div></div>
    <div class="stat"><div class="val">${total}</div><div class="lbl">Total Tasks</div></div>
    <div class="stat"><div class="val">${total?Math.round(done/total*100):0}%</div><div class="lbl">Completion</div></div>
  `;
  updateGlobalStats();
}

function cardHTML(t){
  return `<div class="card priority-${t.priority||'medium'}" draggable="true" data-id="${t.id}" ondragstart="dragStart(event)">
    <div class="card-title">${esc(t.title)}</div>
    <div class="card-meta">
      <span class="agent-dot" style="background:${COLORS[t.agent]||'var(--text3)'}"></span>
      <span style="font-size:11px;color:var(--text2)">${t.agent||''}</span>
      <span class="badge-pill ${t.priority}">${t.priority||'med'}</span>
    </div>
    <div class="card-actions">
      <button class="btn btn-ghost btn-sm" onclick="deleteTask('${t.id}')">‚úï</button>
    </div>
  </div>`;
}

function deleteTask(id){
  tasks=tasks.filter(t=>t.id!==id);persist();renderTasks();
}

// Drag & Drop
function dragStart(e){dragId=e.currentTarget.dataset.id;e.currentTarget.classList.add('dragging');}
function dragOver(e){e.preventDefault();e.currentTarget.querySelector('.kanban-cards').classList.add('drag-over');}
function dragLeave(e){e.currentTarget.querySelector('.kanban-cards').classList.remove('drag-over');}
function drop(e,status){
  e.preventDefault();
  e.currentTarget.querySelector('.kanban-cards').classList.remove('drag-over');
  const t=tasks.find(x=>x.id===dragId);
  if(t){t.status=status;persist();renderTasks();}
  dragId=null;
}

bindFilters('taskFilters',()=>taskFilter,v=>{taskFilter=v;},renderTasks);

// ‚îÄ‚îÄ‚îÄ CONTENT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderContent(){
  let items=contentItems;
  if(contentAgent!=='all')items=items.filter(c=>c.agent===contentAgent);
  if(contentPillar!=='all')items=items.filter(c=>c.pillar===contentPillar);
  ['Draft','Review','Approved','Posted'].forEach(s=>{
    const col=items.filter(c=>c.status===s);
    document.getElementById('ccol-'+s).innerHTML=col.length?col.map(contentCardHTML).join(''):'<div style="text-align:center;padding:20px;color:var(--text3);font-size:12px">Empty</div>';
    document.getElementById('ccnt-'+s).textContent=col.length;
  });
  updateGlobalStats();
}

function contentCardHTML(c){
  return `<div class="card">
    <div class="card-title">${esc(c.title)}</div>
    <div class="card-meta" style="margin-bottom:6px">
      <span class="agent-dot" style="background:${COLORS[c.agent]||'var(--text3)'}"></span>
      <span class="badge-pill">${c.pillar}</span>
      <span class="badge-pill" style="background:var(--bg4);color:var(--text2)">${c.platform}</span>
    </div>
    ${c.notes?`<div style="font-size:11px;color:var(--text2);line-height:1.4">${esc(c.notes)}</div>`:''}
    <div class="card-actions" style="margin-top:8px">
      <button class="btn btn-ghost btn-sm" onclick="deleteContent('${c.id}')">‚úï</button>
    </div>
  </div>`;
}

function deleteContent(id){contentItems=contentItems.filter(c=>c.id!==id);persist();renderContent();}
bindFilters('contentAgentFilters',()=>contentAgent,v=>{contentAgent=v;},renderContent);
bindFilters('contentPillarFilters',()=>contentPillar,v=>{contentPillar=v;},renderContent);

// ‚îÄ‚îÄ‚îÄ APPROVALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderApprovals(){
  const pending=approvals.filter(a=>a.status==='pending');
  const resolved=approvals.filter(a=>a.status!=='pending');
  let html='';
  if(!pending.length&&!showHistory){html='<div class="empty"><div class="empty-icon">‚úÖ</div><p>No pending approvals. All clear!</p></div>';}
  pending.sort((a,b)=>{const p={high:0,medium:1,low:2};return p[a.priority]-p[b.priority];}).forEach(a=>{html+=approvalCardHTML(a);});
  if(showHistory){
    if(resolved.length){html+=`<div style="font-size:12px;color:var(--text3);margin:16px 0 8px;text-transform:uppercase;letter-spacing:1px">History</div>`;}
    resolved.forEach(a=>{html+=approvalCardHTML(a);});
  }
  document.getElementById('approvalsList').innerHTML=html||'<div class="empty"><div class="empty-icon">‚úÖ</div><p>No pending approvals.</p></div>';
  updateGlobalStats();
}

function approvalCardHTML(a){
  const typeClass='type-'+a.type.toLowerCase().replace(' ','-');
  const resolved=a.status!=='pending';
  return `<div class="approval-card ${a.priority} ${resolved?'resolved':''}">
    <div class="approval-header">
      <span class="agent-dot" style="background:${COLORS[a.agent]||'var(--text3)'}"></span>
      <div class="approval-title">${esc(a.title)}</div>
      <span class="type-badge ${typeClass}">${a.type}</span>
      <span class="badge-pill ${a.priority}">${a.priority}</span>
    </div>
    <div class="approval-desc">${esc(a.description)}</div>
    ${!resolved?`<div class="approval-actions">
      <button class="btn btn-green btn-sm" onclick="resolveApproval('${a.id}','approved')">‚úì Approve</button>
      <button class="btn btn-red btn-sm" onclick="resolveApproval('${a.id}','rejected')">‚úï Reject</button>
    </div>`:`<div style="font-size:11px;color:var(--text3)">${a.status.toUpperCase()} ¬∑ ${timeAgo(a.resolved)}</div>`}
  </div>`;
}

function resolveApproval(id,status){
  const a=approvals.find(x=>x.id===id);
  if(a){a.status=status;a.resolved=new Date().toISOString();}
  persist();renderApprovals();
}

function toggleApprovalHistory(){
  showHistory=!showHistory;
  document.getElementById('historyBtn').textContent=showHistory?'Hide History':'Show History';
  renderApprovals();
}

// ‚îÄ‚îÄ‚îÄ DOCS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderDocs(){
  const q=(document.getElementById('docSearch').value||'').toLowerCase();
  let items=docs;
  if(docCat!=='all')items=items.filter(d=>d.category===docCat);
  if(q)items=items.filter(d=>(d.title+d.description+(d.tags||[]).join(' ')).toLowerCase().includes(q));
  document.getElementById('docsGrid').innerHTML=items.length?items.map(docCardHTML).join(''):'<div class="empty" style="grid-column:1/-1"><div class="empty-icon">üìÅ</div><p>No docs found</p></div>';
}

function docCardHTML(d){
  return `<div class="doc-card" onclick="openDoc('${d.id}')">
    <div class="doc-cat cat-${d.category.toLowerCase()}">${d.category}</div>
    <div class="doc-title">${esc(d.title)}</div>
    <div style="display:flex;align-items:center;gap:6px;margin-bottom:6px">
      <span class="agent-dot" style="background:${COLORS[d.agent]||'var(--text3)'}"></span>
      <span style="font-size:11px;color:var(--text2)">${d.agent}</span>
    </div>
    <div class="doc-desc">${esc(d.description)}</div>
    <div class="doc-tags">${(d.tags||[]).map(t=>`<span class="doc-tag">${t}</span>`).join('')}</div>
  </div>`;
}

async function openDoc(id){
  const d=docs.find(x=>x.id===id);if(!d)return;
  document.getElementById('docPanelTitle').textContent=d.title;
  document.getElementById('docPanelContent').textContent='Loading...';
  document.getElementById('docPanel').classList.add('open');
  try{
    const r=await fetch('/api/docs?path='+encodeURIComponent(d.file_path));
    const j=await r.json();
    document.getElementById('docPanelContent').textContent=j.content||'(empty file)';
  }catch{
    document.getElementById('docPanelContent').textContent=`üìÑ ${d.file_path}\n\n${d.description}\n\nFile preview requires the Mac mini to be running.`;
  }
}

function closeDocPanel(){document.getElementById('docPanel').classList.remove('open');}
function deleteDoc(id){docs=docs.filter(d=>d.id!==id);persist();renderDocs();}
bindFilters('docCatFilters',()=>docCat,v=>{docCat=v;},renderDocs);

// ‚îÄ‚îÄ‚îÄ ACTIVITY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function fetchAndRenderActivity(){
  const feed=document.getElementById('activityFeed');
  feed.innerHTML='<div style="padding:20px;color:var(--text3);text-align:center;font-size:12px">Loading‚Ä¶</div>';
  try{
    const r=await fetch('/api/activity');
    if(r.ok){
      const remote=await r.json();
      // normalize: API uses timestamp, local uses ts
      activities=remote.map(a=>({...a,ts:a.ts||a.timestamp}));
      save('activity',activities);
    }
  }catch{}
  renderActivity();
}
function renderActivity(){
  const filtered=activityFilter==='all'?activities:activities.filter(a=>a.agent===activityFilter);
  const sorted=[...filtered].sort((a,b)=>new Date(b.ts||b.timestamp)-new Date(a.ts||a.timestamp));
  document.getElementById('activityFeed').innerHTML=sorted.length?sorted.map(a=>`
    <div class="activity-item">
      <div class="activity-dot" style="background:${COLORS[a.agent]||'var(--text3)'}"></div>
      <div class="activity-right">
        <div class="activity-agent" style="color:${COLORS[a.agent]||'var(--text3)'}">${a.agent}</div>
        <div class="activity-action">${esc(a.action)}</div>
        ${a.details?`<div class="activity-details">${esc(a.details)}</div>`:''}
        <div class="activity-time">${timeAgo(a.ts||a.timestamp)}</div>
      </div>
    </div>
  `).join(''):'<div class="empty"><div class="empty-icon">‚ö°</div><p>No activity yet</p></div>';
}

bindFilters('activityFilters',()=>activityFilter,v=>{activityFilter=v;},renderActivity);

// ‚îÄ‚îÄ‚îÄ TEAM (static HTML ‚Äî no render needed) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderTeam(){
  // Team section is static HTML ‚Äî nothing to render
  // Avatar images are loaded via loadAvatars()
}

// Avatar URLs ‚Äî update these once Higgsfield images are generated
const AVATARS = {
  charlie: '/avatars/charlie.png',
  neo: '/avatars/neo.png',
  drago: '/avatars/drago.png',
  happy: '/avatars/happy.png',
  bob: '/avatars/bob.png',
};

function loadAvatars(){
  Object.entries(AVATARS).forEach(([agent, url])=>{
    if(!url) return;
    const el = document.getElementById('avatar-'+agent);
    if(!el) return;
    const img = document.createElement('img');
    img.src = url;
    img.onerror = ()=>{}; // keep emoji fallback
    img.onload = ()=>{ el.innerHTML=''; el.appendChild(img); };
  });
}

// ‚îÄ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openModal(type){
  const m=document.getElementById('modalContent');
  const o=document.getElementById('modalOverlay');
  if(type==='task') m.innerHTML=`
    <h2>+ New Task</h2>
    <div class="form-group"><label>Title</label><input id="mTitle" placeholder="What needs to be done?"></div>
    <div class="form-group"><label>Agent</label><select id="mAgent"><option value="charlie">üöÄ Charlie</option><option value="neo">üï∂Ô∏è Neo</option><option value="drago">ü•ä Drago</option><option value="happy">‚õ≥ Happy</option></select></div>
    <div class="form-group"><label>Priority</label><select id="mPriority"><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option></select></div>
    <div class="form-group"><label>Status</label><select id="mStatus"><option value="todo">To Do</option><option value="in-progress">In Progress</option><option value="review">Review</option><option value="done">Done</option></select></div>
    <div class="modal-actions"><button class="btn btn-ghost" onclick="closeModal()">Cancel</button><button class="btn btn-coral" onclick="submitTask()">Add Task</button></div>`;
  else if(type==='content') m.innerHTML=`
    <h2>+ New Content</h2>
    <div class="form-group"><label>Title</label><input id="mTitle" placeholder="Content title or concept"></div>
    <div class="form-group"><label>Agent</label><select id="mAgent"><option value="charlie">üöÄ Charlie</option><option value="neo">üï∂Ô∏è Neo</option><option value="drago">ü•ä Drago</option><option value="happy">‚õ≥ Happy</option></select></div>
    <div class="form-group"><label>Pillar</label><select id="mPillar"><option>Dropship</option><option>KYVO</option><option>Golf</option><option>BBA</option></select></div>
    <div class="form-group"><label>Platform</label><select id="mPlatform"><option>Instagram</option><option>TikTok</option><option>YouTube</option><option>Facebook Ad</option><option>Email</option></select></div>
    <div class="form-group"><label>Status</label><select id="mCStatus"><option>Draft</option><option>Review</option><option>Approved</option><option>Posted</option></select></div>
    <div class="form-group"><label>Notes</label><textarea id="mNotes" placeholder="Hook, angle, brief..."></textarea></div>
    <div class="modal-actions"><button class="btn btn-ghost" onclick="closeModal()">Cancel</button><button class="btn btn-coral" onclick="submitContent()">Add Content</button></div>`;
  else if(type==='approval') m.innerHTML=`
    <h2>+ Approval Request</h2>
    <div class="form-group"><label>Title</label><input id="mTitle" placeholder="Short description of what needs approval"></div>
    <div class="form-group"><label>Description</label><textarea id="mDesc" placeholder="Full context for Tommy to make a decision..."></textarea></div>
    <div class="form-group"><label>Requesting Agent</label><select id="mAgent"><option value="charlie">üöÄ Charlie</option><option value="neo">üï∂Ô∏è Neo</option><option value="drago">ü•ä Drago</option><option value="happy">‚õ≥ Happy</option></select></div>
    <div class="form-group"><label>Type</label><select id="mType"><option>Content</option><option>Ad Spend</option><option>Action</option><option>Campaign</option></select></div>
    <div class="form-group"><label>Priority</label><select id="mPriority"><option value="high">High</option><option value="medium">Medium</option><option value="low">Low</option></select></div>
    <div class="modal-actions"><button class="btn btn-ghost" onclick="closeModal()">Cancel</button><button class="btn btn-coral" onclick="submitApproval()">Submit Request</button></div>`;
  else if(type==='doc') m.innerHTML=`
    <h2>+ Add Document</h2>
    <div class="form-group"><label>Title</label><input id="mTitle" placeholder="Document name"></div>
    <div class="form-group"><label>Agent</label><select id="mAgent"><option value="charlie">üöÄ Charlie</option><option value="neo">üï∂Ô∏è Neo</option><option value="drago">ü•ä Drago</option><option value="happy">‚õ≥ Happy</option></select></div>
    <div class="form-group"><label>Category</label><select id="mCat"><option>SOP</option><option>Copy</option><option>Script</option><option>Strategy</option><option>Research</option><option>Pipeline</option></select></div>
    <div class="form-group"><label>Description</label><textarea id="mDesc" placeholder="Brief description..."></textarea></div>
    <div class="form-group"><label>File Path</label><input id="mPath" placeholder="/Users/charlieclaw/.openclaw/workspace/..."></div>
    <div class="modal-actions"><button class="btn btn-ghost" onclick="closeModal()">Cancel</button><button class="btn btn-coral" onclick="submitDoc()">Add Doc</button></div>`;
  o.classList.add('open');
}

function closeModal(){document.getElementById('modalOverlay').classList.remove('open');}

function submitTask(){
  const title=document.getElementById('mTitle').value.trim();if(!title)return;
  tasks.push({id:genId(),title,agent:document.getElementById('mAgent').value,priority:document.getElementById('mPriority').value,status:document.getElementById('mStatus').value,created:new Date().toISOString()});
  persist();closeModal();renderTasks();
  syncToAPI('tasks',tasks[tasks.length-1]);
}

function submitContent(){
  const title=document.getElementById('mTitle').value.trim();if(!title)return;
  contentItems.push({id:genId(),title,agent:document.getElementById('mAgent').value,pillar:document.getElementById('mPillar').value,platform:document.getElementById('mPlatform').value,status:document.getElementById('mCStatus').value,notes:document.getElementById('mNotes').value,created:new Date().toISOString()});
  persist();closeModal();renderContent();
}

function submitApproval(){
  const title=document.getElementById('mTitle').value.trim();if(!title)return;
  approvals.push({id:genId(),title,description:document.getElementById('mDesc').value,agent:document.getElementById('mAgent').value,type:document.getElementById('mType').value,priority:document.getElementById('mPriority').value,status:'pending',created:new Date().toISOString()});
  persist();closeModal();renderApprovals();
}

function submitDoc(){
  const title=document.getElementById('mTitle').value.trim();if(!title)return;
  docs.push({id:genId(),title,agent:document.getElementById('mAgent').value,category:document.getElementById('mCat').value,description:document.getElementById('mDesc').value,file_path:document.getElementById('mPath').value,tags:[],created:new Date().toISOString()});
  persist();closeModal();renderDocs();
}

// ‚îÄ‚îÄ‚îÄ API SYNC (best-effort, no UI dependency) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function syncToAPI(type,item){
  try{
    await fetch('/api/'+type,{method:'POST',headers:{'Content-Type':'application/json','X-API-Key':API_KEY},body:JSON.stringify(item)});
  }catch{}
}

// ‚îÄ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function esc(s){if(!s)return'';const d=document.createElement('div');d.textContent=s;return d.innerHTML;}
function timeAgo(ts){
  if(!ts)return'';
  const s=Math.floor((Date.now()-new Date(ts))/1e3);
  if(s<60)return s+'s ago';if(s<3600)return Math.floor(s/60)+'m ago';
  if(s<86400)return Math.floor(s/3600)+'h ago';
  return Math.floor(s/86400)+'d ago';
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
fetchAndRenderTasks();updateGlobalStats();loadAvatars();
</script>
</body>
</html>
